--LIGAS Y EQUIPOS
CREATE TABLE leagues (
    league_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    country VARCHAR(50) NOT NULL,
    season VARCHAR(20) NOT NULL,
    level VARCHAR(20) NOT NULL
);

CREATE TABLE teams (
    team_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    country VARCHAR(50) NOT NULL,
    founded_year SMALLINT NOT NULL,
    stadium VARCHAR(50) NOT NULL,
    logo_url VARCHAR(255),
    league_id INT REFERENCES leagues(league_id) ON DELETE CASCADE
);

--JUGADORES Y ENTRENADORES
CREATE TABLE coaches (
    coach_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    nationality VARCHAR(30) NOT NULL,
    experienced_years SMALLINT,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE
);

CREATE TABLE players (
    player_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    position VARCHAR(50) NOT NULL,
    age SMALLINT NOT NULL,
    nationality VARCHAR(30) NOT NULL,
    height SMALLINT NOT NULL,
    weight SMALLINT NOT NULL,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE
);

--PARTIDOS Y ÁRBITROS
CREATE TABLE referee (
    referee_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    nationality VARCHAR(30),
    experience_years SMALLINT
);

CREATE TABLE matches (
    match_id SERIAL PRIMARY KEY,
    match_date DATE NOT NULL,
    home_team INT REFERENCES teams(team_id),
    away_team INT REFERENCES teams(team_id),
    home_score SMALLINT,
    away_score SMALLINT,
    referee_id INT REFERENCES referees(referee_id)
);

--ESTADÍSTICAS
CREATE TABLE player_stats (
    stat_id SERIAL PRIMARY KEY,
    player_id INT REFERENCES players(player_id) ON DELETE CASCADE,
    match_id INT REFERENCES matches(match_id) ON DELETE CASCADE,
    goals INT DEFAULT 0,
    assists INT DEFAULT 0,
    yellow_cards INT DEFAULT 0,
    red_cards INT DEFAULT 0,
    minutes_played INT DEFAULT 0
);

CREATE TABLE team_stats (
    team_stat_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    match_id INT REFERENCES matches(match_id),
    possession DECIMAL(5,2),
    shots INT,
    fouls INT,
    corners INT
);

--RIVALIDADES
CREATE TABLE rivalries (
    rivalry_id SERIAL PRIMARY KEY,
    team_a_id INT REFERENCES teams(team_id),
    team_b_id INT REFERENCES teams(team_id),
    description TEXT
);

--CONTRATOS
CREATE TABLE contracts (
    contract_id SERIAL PRIMARY KEY,
    entity_type VARCHAR(10) CHECK (entity_type IN ('player','coach')),
    entity_id INT NOT NULL,
    team_id INT REFERENCES teams(team_id),
    start_date DATE NOT NULL,
    end_date DATE,
    salary DECIMAL(12,2),
    release_clause DECIMAL(12,2)
);

--NOTICIAS, SENTIMIENTOS Y TENDENCIAS
	CREATE TABLE news (
	    news_id SERIAL PRIMARY KEY,
	    title VARCHAR(200) NOT NULL,
	    content TEXT NOT NULL,
	    publish_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	    author VARCHAR(50),
	    source_url VARCHAR(255),
	    image_url VARCHAR(255),
	    team_id INT REFERENCES teams(team_id)
	);

CREATE TABLE sentiments (
    sentiment_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    source VARCHAR(50),
    sentiment VARCHAR(20) CHECK (sentiment IN ('positive','neutral','negative')),
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE trending_topics (
    topic_id SERIAL PRIMARY KEY,
    social_media VARCHAR(50) NOT NULL,
    topic VARCHAR(200) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--PATROCINIOS Y PRODUCTOS
CREATE TABLE sponsorships (
    sponsorship_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE,
    sponsor_name VARCHAR(100) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE,
    amount DECIMAL(12,2),
    logo_url VARCHAR(255)
);

CREATE TABLE merchandise (
    product_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    name VARCHAR(100) NOT NULL,
    category VARCHAR(50),
    price DECIMAL(10,2),
    stock INT,
    image_url VARCHAR(255)
);

--USUARIOS, FANS Y FAVORITOS
CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,
    username VARCHAR(100) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE fans (
    fan_id SERIAL PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    social_media VARCHAR(50) NOT NULL,
    profile_picture_url VARCHAR(255),
    team_id INT REFERENCES teams(team_id),
    registered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE favorites (
    favorite_id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(user_id) ON DELETE CASCADE,
    entity_type VARCHAR(20) CHECK (entity_type IN ('team','player')),
    entity_id INT NOT NULL
);

--ENCUESTAS Y VOTACIONES
CREATE TABLE polls (
    poll_id SERIAL PRIMARY KEY,
    question TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP
);

CREATE TABLE poll_votes (
    vote_id SERIAL PRIMARY KEY,
    poll_id INT REFERENCES polls(poll_id) ON DELETE CASCADE,
    user_id INT REFERENCES users(user_id),
    option_selected VARCHAR(100)
);



CREATE TABLE roles (
    role_id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE,
    description TEXT
);
ALTER TABLE users
ADD COLUMN role_id INT,
ADD CONSTRAINT fk_user_role
 FOREIGN KEY (role_id) REFERENCES roles(role_id);

	
INSERT INTO roles (name, description) VALUES ('ADMIN', 'Administrador del sistema');
INSERT INTO roles (name, description) VALUES ('USER', 'Usuario estándar del sistema');

-- Insertar usuario 'admin' (Rol: ADMIN, asumiendo role_id = 1)
INSERT INTO users (username, email, password_hash, role_id)
VALUES ('admin', 'admin@scoresense.com', 'TU_HASH_ADMIN', 
        (SELECT role_id FROM roles WHERE name = 'ADMIN'));

-- Insertar usuario 'usePrueba' (Rol: USER, asumiendo role_id = 2)
INSERT INTO users (username, email, password_hash, role_id)
VALUES ('usePrueba', 'userprueba@scoresense.com', 'TU_HASH_USERPRUEBA', 
        (SELECT role_id FROM roles WHERE name = 'USER'));


Select * from users;
Select * from roles;
Select * from players;
Select * from teams;
Select * from coaches;
Select * from matches;
Select * from referee;
Select * from news;
Select * from favorites;




ALTER TABLE matches
ADD COLUMN referee_id INT REFERENCES referee(referee_id);


--Mau - Matches ,player stats,players, news,favorites


INSERT INTO leagues (name, country, season, level) VALUES
('Liga MX', 'Mexico', 'Apertura 2025', 'First Division'),
('La Liga', 'Spain', '2024-2025', 'First Division'),
('Premier League', 'England', '2024-2025', 'First Division'),
('Serie A', 'Italy', '2024-2025', 'First Division'),
('Bundesliga', 'Germany', '2024-2025', 'First Division'),
('Ligue 1', 'France', '2024-2025', 'First Division'),
('MLS', 'USA', '2025', 'First Division'),
('Eredivisie', 'Netherlands', '2024-2025', 'First Division'),
('Primeira Liga', 'Portugal', '2024-2025', 'First Division'),
('Brasileirão Série A', 'Brazil', '2025', 'First Division');


-- 3 Equipos de Liga MX (league_id = 1)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Club Universidad Nacional (Pumas)', 'Mexico', 1954, 'Estadio Olímpico Universitario', 'NA', 1),
('Club America', 'Mexico', 1916, 'Estadio Azteca', 'NA', 1),
('Chivas Guadalajara', 'Mexico', 1906, 'Estadio Akron', 'NA', 1);

-- 3 Equipos de Premier League (league_id = 3)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Manchester United', 'England', 1878, 'Old Trafford', 'NA', 3),
('Liverpool FC', 'England', 1892, 'Anfield', 'NA', 3),
('Arsenal FC', 'England', 1886, 'Emirates Stadium', 'NA', 3);

-- 3 Equipos de La Liga (league_id = 2)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Real Madrid CF', 'Spain', 1902, 'Santiago Bernabéu', 'NA', 2),
('FC Barcelona', 'Spain', 1899, 'Spotify Camp Nou', 'NA', 2),
('Atlético de Madrid', 'Spain', 1903, 'Cívitas Metropolitano', 'NA', 2);

-- 3 Equipos de Serie A (league_id = 4)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Juventus FC', 'Italy', 1897, 'Allianz Stadium', 'NA', 4),
('AC Milan', 'Italy', 1899, 'San Siro', 'NA', 4),
('Inter Milan', 'Italy', 1908, 'San Siro', 'NA', 4);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Marcus Rashford', 'Delantero', 27, 'England', 185, 70, 7),
('Bruno Fernandes', 'Mediocampista', 30, 'Portugal', 179, 80, 7),
('Casemiro', 'Mediocampista', 32, 'Brazil', 185, 84, 7),
('Raphaël Varane', 'Defensa', 31, 'France', 191, 81, 7),
('André Onana', 'Portero', 28, 'Cameroon', 190, 93, 7),
('Mason Mount', 'Mediocampista', 25, 'England', 178, 74, 7),
('Alejandro Garnacho', 'Delantero', 20, 'Argentina', 180, 70, 7);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Vinícius Júnior', 'Delantero', 25, 'Brazil', 176, 73, 4),
('Jude Bellingham', 'Mediocampista', 21, 'England', 186, 78, 4),
('Thibaut Courtois', 'Portero', 32, 'Belgium', 200, 96, 4),
('Eduardo Camavinga', 'Mediocampista', 22, 'France', 182, 68, 4),
('Éder Militão', 'Defensa', 26, 'Brazil', 186, 78, 4),
('Toni Kroos', 'Mediocampista', 34, 'Germany', 183, 76, 4),
('Federico Valverde', 'Mediocampista', 26, 'Uruguay', 182, 78, 4),
('Rodrygo', 'Delantero', 23, 'Brazil', 175, 64, 4);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Alexis Vega', 'Delantero', 27, 'Mexico', 174, 73, 3),
('Roberto Alvarado', 'Mediocampista', 26, 'Mexico', 176, 67, 3),
('Jesús Orozco', 'Defensa', 22, 'Mexico', 183, 75, 3),
('Fernando Gago', 'Mediocampista', 38, 'Argentina', 177, 74, 3);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Henry Martín', 'Delantero', 32, 'Mexico', 178, 79, 2),
('Julián Quiñones', 'Delantero', 27, 'Colombia', 178, 76, 2),
('Álvaro Fidalgo', 'Mediocampista', 28, 'Spain', 174, 71, 2),
('Luis Malagón', 'Portero', 27, 'Mexico', 181, 75, 2);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Keylor Navas', 'Portero', 38, 'Costa Rica', 185, 80, 1),
('Nathan Silva', 'Defensa', 29, 'Brazil', 182, 84, 1),
('Rubén Duarte', 'Defensa', 30, 'Spain', 180, 75, 1),
('José Caicedo', 'Mediocampista', 24, 'Colombia', 179, 75, 1),
('Adalberto Carrasquilla', 'Mediocampista', 27, 'Panama', 170, 65, 1),
('Guillermo Martínez', 'Delantero', 31, 'Mexico', 191, 91, 1),
('José Juan Macías', 'Delantero', 26, 'Mexico', 178, 76, 1);

---------------data
-- Asunciones de team_id (basadas en tu última imagen y orden de inserción):
-- Pumas: 1, America: 2, Chivas: 3
-- Manchester United: 4, Liverpool FC: 5, Arsenal FC: 6
-- Real Madrid CF: 7, FC Barcelona: 8, Atlético de Madrid: 9
-- Juventus FC: 10

-- Liga MX (3 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
	('Efraín Juárez', 'Mexico', 5, 1),      -- Pumas
('André Jardine', 'Brazil', 12, 2),     -- Club America
('Fernando Gago', 'Argentina', 4, 3);    -- Chivas Guadalajara

-- Premier League (2 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Erik ten Hag', 'Netherlands', 10, 4),  -- Manchester United
('Jürgen Klopp', 'Germany', 24, 5);      -- Liverpool FC (team_id 5)

-- Premier League (1 Entrenador)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Mikel Arteta', 'Spain', 7, 6);         -- Arsenal FC (team_id 6)

-- La Liga (3 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Carlo Ancelotti', 'Italy', 28, 7),     -- Real Madrid CF (team_id 7)
('Hansi Flick', 'Germany', 15, 8),       -- FC Barcelona (team_id 8)
('Diego Simeone', 'Argentina', 18, 9);   -- Atlético de Madrid (team_id 9)

-- Serie A (1 Entrenador)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Thiago Motta', 'Italy', 6, 10);        -- Juventus FC (team_id 10)




-----------
INSERT INTO referee (name, nationality, experience_years) VALUES
('Arturo Ramos', 'Mexico', 10),
('Alejandro Hernández', 'Spain', 15),
('Michael Oliver', 'England', 18),
('Daniele Orsato', 'Italy', 20),
('Clément Turpin', 'France', 14);


-- JORNADA 1
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-28', 1, 2, 2, 1, 1),
('2025-11-28', 3, 12, 1, 1, 1);

-- JORNADA 2
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-29', 7, 8, 3, 2, 2),
('2025-11-29', 9, 7, 0, 1, 2);

-- JORNADA 3
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-30', 4, 5, 1, 1, 3),
('2025-11-30', 6, 4, 2, 0, 3);

-- JORNADA 4
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-01', 10, 11, 0, 0, 4),
('2025-12-01', 12, 10, 2, 1, 4);

-- JORNADA 5
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-05', 8, 9, 4, 1, 5),
('2025-12-05', 5, 6, 3, 0, 5);

-- JORNADA 6
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-06', 11, 12, 1, 2, 1),
('2025-12-06', 2, 3, 0, 0, 1);

-- JORNADA 7
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-07', 1, 3, 3, 0, 2),
('2025-12-07', 2, 1, 1, 0, 2);

-- JORNADA 8
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-08', 4, 6, 0, 2, 3),
('2025-12-08', 7, 9, 2, 2, 3);

-- JORNADA 9
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-09', 10, 5, 1, 0, 4),
('2025-12-09', 3, 2, 1, 3, 4);

-- JORNADA 10
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-10', 6, 5, 2, 1, 5),
('2025-12-10', 8, 7, 1, 1, 5);


-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 1: Pumas (1) vs America (2) | Resultado: 2-1
-- =============================================

-- Gol de Guillermo Martínez (Pumas - ID 29)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played, yellow_cards) 
VALUES (29, 1, 1, 0, 90, 0);

-- Gol de JJ Macías (Pumas - ID 30) 
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (30, 1, 1, 0, 45);

-- Asistencia de Carrasquilla (ID 28)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (28, 1, 0, 1, 85);

-- Gol de Henry Martín (América - ID 20)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (20, 1, 1, 0, 90);

-- Tarjeta amarilla para Álvaro Fidalgo (América - ID 22)
INSERT INTO player_stats (player_id, match_id, yellow_cards, minutes_played) 
VALUES (22, 1, 1, 90);

-- Portero Keylor Navas (Pumas - ID 24)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (24, 1, 90);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 2: Chivas (3) vs Inter (12) | Resultado: 1-1
-- =============================================

-- Gol de Alexis Vega (Chivas - ID 16) con amarilla
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played, yellow_cards) 
VALUES (16, 2, 1, 0, 88, 1);

-- Asistencia de Roberto Alvarado (Chivas - ID 17)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (17, 2, 0, 1, 90);

-- Fernando Gago (Chivas - ID 19) - CORREGIDO: Se eliminó la columna 'fouls'
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (19, 2, 90);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 3: Team 7 vs Team 8 | Resultado: 3-2
-- (Jugadores Man Utd vs Barcelona segun lógica de IDs cruzados)
-- =============================================

-- Marcus Rashford (ID 1) - Doblete
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (1, 3, 2, 0, 90);

-- Bruno Fernandes (ID 2) - 1 Gol y 1 Asistencia
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (2, 3, 1, 1, 90);

-- Casemiro (ID 3) - Tarjeta Roja
INSERT INTO player_stats (player_id, match_id, red_cards, minutes_played) 
VALUES (3, 3, 1, 65);

-- Alejandro Garnacho (ID 7) - Entró de cambio
INSERT INTO player_stats (player_id, match_id, minutes_played, assists) 
VALUES (7, 3, 25, 1);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 5: Team 4 vs Team 5 | Resultado: 1-1
-- (Jugadores Real Madrid)
-- =============================================

-- Vinícius Júnior (ID 8) - 1 Gol y Amarilla
INSERT INTO player_stats (player_id, match_id, goals, minutes_played, yellow_cards) 
VALUES (8, 5, 1, 90, 1);

-- Jude Bellingham (ID 9) - 1 Asistencia
INSERT INTO player_stats (player_id, match_id, assists, minutes_played) 
VALUES (9, 5, 1, 90);

-- Thibaut Courtois (ID 10) - Portero
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (10, 5, 90);

-- Toni Kroos (ID 13)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (13, 5, 80);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 7: Pumas (1) vs Chivas (3) | Resultado: 3-0
-- =============================================

-- Hat-trick de Memo Martínez (Pumas - ID 29)
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (29, 7, 3, 90);

-- Asistencias de Nathan Silva (ID 25)
INSERT INTO player_stats (player_id, match_id, assists, minutes_played) 
VALUES (25, 7, 1, 90);

-- Orozco (ID 18) expulsado
INSERT INTO player_stats (player_id, match_id, red_cards, minutes_played) 
VALUES (18, 7, 1, 30);

-- =============================================
-- OTROS PARTIDOS
-- =============================================

-- Partido 6: Valverde (ID 14) con amarilla
INSERT INTO player_stats (player_id, match_id, yellow_cards, minutes_played) 
VALUES (14, 6, 1, 90);

-- Partido 9: Chivas (3) vs America (2)
-- Alvarado (ID 17) Gol
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (17, 9, 1, 90);

-- Quiñones (ID 21) Doblete
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (21, 9, 2, 0, 88);

-- Fidalgo (ID 22) Gol
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (22, 9, 1, 90);

-- Luis Malagón (ID 23)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (23, 9, 90);


-- =============================================
-- NOTICIAS DE LA JORNADA 1 y 2 (Finales de Noviembre 2025)
-- =============================================

INSERT INTO news (title, content, publish_date, author, source_url, image_url, team_id) VALUES
('Pumas se lleva el Clásico Capitalino', 'En un partido vibrante, Pumas logró vencer al América 2-1 gracias a los goles de Memo Martínez y JJ Macías. La afición universitaria celebra en el Olímpico.', '2025-11-28 22:30:00', 'Juan Futbol', 'https://scoresense.com/news/pumas-america-resumen', 'na', 1),

('Dudas en Coapa tras la derrota', 'André Jardine no encuentra la fórmula defensiva. La derrota contra Pumas deja muchas interrogantes sobre el planteamiento táctico de las Águilas.', '2025-11-29 09:00:00', 'Carlos Reinoso', 'https://scoresense.com/news/america-crisis', 'na', 2),

('Chivas rescata un empate internacional', 'El Rebaño Sagrado logró un empate 1-1 contra el Inter de Milán en un amistoso de alto nivel. Alexis Vega fue la figura del encuentro.', '2025-11-29 10:15:00', 'ChivaHermano', 'https://scoresense.com/news/chivas-inter', 'na', 3),

('El Clásico Español se tiñe de blanco', 'Real Madrid venció 3-2 al Barcelona en un partido de locura. Marcus Rashford fue el héroe inesperado con un doblete espectacular.', '2025-11-30 08:00:00', 'Marca', 'https://scoresense.com/news/real-madrid-barcelona', 'na', 7),

('Polémica expulsión de Casemiro', 'El mediocampista vio la tarjeta roja en el minuto 65, dejando a su equipo con diez hombres. El arbitraje de Alejandro Hernández está bajo la lupa.', '2025-11-30 12:45:00', 'Mundo Deportivo', 'https://scoresense.com/news/casemiro-red-card', 'na', 7),

-- =============================================
-- NOTICIAS DE LA JORNADA 3 y 4 (Inicios de Diciembre 2025)
-- =============================================

('Vinícius brilla en la Premier League', 'El brasileño anotó un gol decisivo para el Manchester United en el empate contra Liverpool. Su adaptación al fútbol inglés está siendo rápida.', '2025-12-01 14:20:00', 'Sky Sports', 'https://scoresense.com/news/vini-premier', 'na', 4),

('Jude Bellingham, el rey de las asistencias', 'Otra asistencia clave del inglés para el United. Se ha convertido en el motor del mediocampo de Ten Hag esta temporada.', '2025-12-01 16:00:00', 'The Sun', 'https://scoresense.com/news/bellingham-stats', 'na', 4),

('Juventus mantiene su arco en cero', 'Thiago Motta ha construido una muralla. Empate sin goles contra el Milan que demuestra la solidez defensiva de la Vecchia Signora.', '2025-12-02 10:00:00', 'Gazzetta', 'https://scoresense.com/news/juve-milan', 'na', 10),

('Arsenal domina pero no concreta', 'A pesar de la victoria 2-0 contra Manchester United, Mikel Arteta pide más contundencia a sus delanteros de cara al arco.', '2025-12-02 18:30:00', 'London Evening', 'https://scoresense.com/news/arsenal-win', 'na', 6),

('El renacer de Alexis Vega', 'Con goles consecutivos, el delantero mexicano parece haber recuperado su mejor versión física y mental bajo el mando de Gago.', '2025-12-03 11:00:00', 'Récord', 'https://scoresense.com/news/alexis-vega-nivel', 'na', 3),

-- =============================================
-- NOTICIAS DE LA JORNADA 5 a 8 (Mediados de Diciembre 2025)
-- =============================================

('Barcelona golea al Atlético', 'Hansi Flick respira tranquilo tras vencer 4-1 al equipo del Cholo Simeone. Una exhibición ofensiva que necesitaban los culés.', '2025-12-05 23:00:00', 'Sport', 'https://scoresense.com/news/barca-atleti-goleada', 'na', 8),

('Crisis total en el Atlético de Madrid', 'Simeone en la cuerda floja. La defensa colchonera hace aguas y la afición empieza a perder la paciencia.', '2025-12-06 09:30:00', 'AS', 'https://scoresense.com/news/atleti-crisis', 'na', 9),

('Memo Martínez: El hombre Hat-Trick', 'Noche histórica para el delantero de Pumas. Tres goles contra Chivas para sentenciar una victoria 3-0 contundente.', '2025-12-07 21:00:00', 'Esto', 'https://scoresense.com/news/pumas-chivas-goleada', 'na', 1),

('Desastre defensivo del Guadalajara', 'La expulsión de Orozco condicionó el partido, pero la falta de reacción del equipo preocupa a la directiva rojiblanca.', '2025-12-08 08:00:00', 'MedioTiempo', 'https://scoresense.com/news/chivas-derrota-pumas', 'na', 3),

('Liverpool recupera sensaciones', 'Victoria cómoda 3-0 contra Arsenal. Salah y Darwin Núñez se entendieron a la perfección en Anfield.', '2025-12-08 15:00:00', 'BBC Sport', 'https://scoresense.com/news/liverpool-arsenal', 'na', 5),

-- =============================================
-- RUMORES Y NOTICIAS GENERALES
-- =============================================

('¿Fernando Gago a Boca?', 'Rumores desde Argentina sitúan al técnico de Chivas fuera de México tras la goleada recibida contra Pumas.', '2025-12-09 12:00:00', 'Olé', 'https://scoresense.com/news/gago-salida', 'na', 3),

('América recupera el vuelo', 'Las Águilas vencen a Chivas 3-1 en el Clásico Nacional. Julián Quiñones fue imparable con dos goles.', '2025-12-10 10:00:00', 'TUDN', 'https://scoresense.com/news/america-chivas-clasico', 'na', 2),

('Malagón pide renovación', 'El portero del América, figura clave en la victoria contra Chivas, espera mejorar su contrato antes de finalizar el año.', '2025-12-10 14:00:00', 'ESPN', 'https://scoresense.com/news/malagon-contrato', 'na', 2),

('Inter de Milán busca refuerzos', 'El equipo italiano tiene visores en la Liga MX. Se rumora interés por jugadores jóvenes de Pumas y América.', '2025-12-11 09:00:00', 'Tuttosport', 'https://scoresense.com/news/inter-scouting', 'na', 12),

('El futuro de Efraín Juárez', 'Tras los excelentes resultados con Pumas, equipos de la MLS empiezan a preguntar por el joven entrenador mexicano.', '2025-12-11 11:00:00', 'Fox Sports', 'https://scoresense.com/news/efrain-juarez-mls', 'na', 1);

INSERT INTO users (username, email, password_hash, role_id) VALUES
('pumaDeCorazon', 'goya_universidad@mail.com', 'hash_puma_123', (SELECT role_id FROM roles WHERE name = 'USER')),
('chivaHermano99', 'rebaño_sagrado@mail.com', 'hash_chivas_456', (SELECT role_id FROM roles WHERE name = 'USER')),
('madridista_gl', 'halamadrid@mail.com', 'hash_rm_789', (SELECT role_id FROM roles WHERE name = 'USER')),
('premierFan_uk', 'london_football@mail.com', 'hash_pl_000', (SELECT role_id FROM roles WHERE name = 'USER')),
('americanista_pro', 'odiamemas@mail.com', 'hash_ame_111', (SELECT role_id FROM roles WHERE name = 'USER'));

-- =============================================
-- FAVORITOS DEL USUARIO: pumaDeCorazon
-- =============================================
INSERT INTO favorites (user_id, entity_type, entity_id) VALUES
((SELECT user_id FROM users WHERE username = 'pumaDeCorazon'), 'team', 1),
((SELECT user_id FROM users WHERE username = 'pumaDeCorazon'), 'player', 29),
((SELECT user_id FROM users WHERE username = 'pumaDeCorazon'), 'player', 30),
((SELECT user_id FROM users WHERE username = 'pumaDeCorazon'), 'team', 7);

-- =============================================
-- FAVORITOS DEL USUARIO: chivaHermano99
-- =============================================
INSERT INTO favorites (user_id, entity_type, entity_id) VALUES
((SELECT user_id FROM users WHERE username = 'chivaHermano99'), 'team', 3),
((SELECT user_id FROM users WHERE username = 'chivaHermano99'), 'player', 16),
((SELECT user_id FROM users WHERE username = 'chivaHermano99'), 'player', 17),
((SELECT user_id FROM users WHERE username = 'chivaHermano99'), 'player', 1);

-- =============================================
-- FAVORITOS DEL USUARIO: madridista_gl
-- =============================================
INSERT INTO favorites (user_id, entity_type, entity_id) VALUES
((SELECT user_id FROM users WHERE username = 'madridista_gl'), 'team', 7),
((SELECT user_id FROM users WHERE username = 'madridista_gl'), 'player', 8),
((SELECT user_id FROM users WHERE username = 'madridista_gl'), 'player', 9),
((SELECT user_id FROM users WHERE username = 'madridista_gl'), 'player', 10);

-- =============================================
-- FAVORITOS DEL USUARIO: premierFan_uk
-- =============================================
INSERT INTO favorites (user_id, entity_type, entity_id) VALUES
((SELECT user_id FROM users WHERE username = 'premierFan_uk'), 'team', 4),
((SELECT user_id FROM users WHERE username = 'premierFan_uk'), 'team', 5),
((SELECT user_id FROM users WHERE username = 'premierFan_uk'), 'team', 6),
((SELECT user_id FROM users WHERE username = 'premierFan_uk'), 'player', 2);

-- =============================================
-- FAVORITOS DEL USUARIO: americanista_pro
-- =============================================
INSERT INTO favorites (user_id, entity_type, entity_id) VALUES
((SELECT user_id FROM users WHERE username = 'americanista_pro'), 'team', 2),
((SELECT user_id FROM users WHERE username = 'americanista_pro'), 'player', 20),
((SELECT user_id FROM users WHERE username = 'americanista_pro'), 'player', 21),
((SELECT user_id FROM users WHERE username = 'americanista_pro'), 'player', 22);


UPDATE player_stats
SET 
    goals = COALESCE(goals, 0),
    assists = COALESCE(assists, 0),
    yellow_cards = COALESCE(yellow_cards, 0),
    red_cards = COALESCE(red_cards, 0),
    minutes_played = COALESCE(minutes_played, 0)
WHERE 
    goals IS NULL OR 
    assists IS NULL OR 
    yellow_cards IS NULL OR 
    red_cards IS NULL OR 
    minutes_played IS NULL;



--consulta de player mas player stats lenguaje natural
-------------

SELECT 
    p.player_id,
    p.name,         
    p.position,
    p.age,
    p.nationality,
    p.height,
    p.weight,
    t.name AS team_name  
FROM players p
JOIN teams t ON p.team_id = t.team_id;

---
SELECT 
    ps.player_stat_id,                
    p.name,            
    t_home.name || ' vs ' || t_away.name AS match_context, -- Shows "Equipo A vs Equipo B"
    ps.goals,                         
    ps.assists,                      
    ps.minutes_played,            
    ps.yellow_cards,                 
    ps.red_cards                      
FROM player_stats ps
JOIN players p ON ps.player_id = p.player_id
JOIN matches m ON ps.match_id = m.match_id
JOIN teams t_home ON m.home_team = t_home.team_id
JOIN teams t_away ON m.away_team = t_away.team_id;


