Registrer bd actualizado 
--LIGAS Y EQUIPOS
CREATE TABLE leagues (
    league_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    country VARCHAR(50) NOT NULL,
    season VARCHAR(20) NOT NULL,
    level VARCHAR(20) NOT NULL
);

CREATE TABLE teams (
    team_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    country VARCHAR(50) NOT NULL,
    founded_year SMALLINT NOT NULL,
    stadium VARCHAR(50) NOT NULL,
    logo_url VARCHAR(255),
    league_id INT REFERENCES leagues(league_id) ON DELETE CASCADE
);

--JUGADORES Y ENTRENADORES
CREATE TABLE coaches (
    coach_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    nationality VARCHAR(30) NOT NULL,
    experienced_years SMALLINT,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE
);

CREATE TABLE players (
    player_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    position VARCHAR(50) NOT NULL,
    age SMALLINT NOT NULL,
    nationality VARCHAR(30) NOT NULL,
    height SMALLINT NOT NULL,
    weight SMALLINT NOT NULL,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE
);

--PARTIDOS Y ÁRBITROS
CREATE TABLE referee (
    referee_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    nationality VARCHAR(30),
    experience_years SMALLINT
);

CREATE TABLE matches (
    match_id SERIAL PRIMARY KEY,
    match_date DATE NOT NULL,
    home_team INT REFERENCES teams(team_id),
    away_team INT REFERENCES teams(team_id),
    home_score SMALLINT,
    away_score SMALLINT,
    referee_id INT REFERENCES referees(referee_id)
);

--ESTADÍSTICAS
CREATE TABLE player_stats (
    stat_id SERIAL PRIMARY KEY,
    player_id INT REFERENCES players(player_id) ON DELETE CASCADE,
    match_id INT REFERENCES matches(match_id) ON DELETE CASCADE,
    goals INT DEFAULT 0,
    assists INT DEFAULT 0,
    yellow_cards INT DEFAULT 0,
    red_cards INT DEFAULT 0,
    minutes_played INT DEFAULT 0
);

CREATE TABLE team_stats (
    team_stat_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    match_id INT REFERENCES matches(match_id),
    possession DECIMAL(5,2),
    shots INT,
    fouls INT,
    corners INT
);

--RIVALIDADES
CREATE TABLE rivalries (
    rivalry_id SERIAL PRIMARY KEY,
    team_a_id INT REFERENCES teams(team_id),
    team_b_id INT REFERENCES teams(team_id),
    description TEXT
);

--CONTRATOS
CREATE TABLE contracts (
    contract_id SERIAL PRIMARY KEY,
    entity_type VARCHAR(10) CHECK (entity_type IN ('player','coach')),
    entity_id INT NOT NULL,
    team_id INT REFERENCES teams(team_id),
    start_date DATE NOT NULL,
    end_date DATE,
    salary DECIMAL(12,2),
    release_clause DECIMAL(12,2)
);

--NOTICIAS, SENTIMIENTOS Y TENDENCIAS
CREATE TABLE news (
    news_id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    publish_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    author VARCHAR(50),
    source_url VARCHAR(255),
    image_url VARCHAR(255),
    team_id INT REFERENCES teams(team_id)
);

CREATE TABLE sentiments (
    sentiment_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    source VARCHAR(50),
    sentiment VARCHAR(20) CHECK (sentiment IN ('positive','neutral','negative')),
    comment TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE trending_topics (
    topic_id SERIAL PRIMARY KEY,
    social_media VARCHAR(50) NOT NULL,
    topic VARCHAR(200) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--PATROCINIOS Y PRODUCTOS
CREATE TABLE sponsorships (
    sponsorship_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id) ON DELETE CASCADE,
    sponsor_name VARCHAR(100) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE,
    amount DECIMAL(12,2),
    logo_url VARCHAR(255)
);

CREATE TABLE merchandise (
    product_id SERIAL PRIMARY KEY,
    team_id INT REFERENCES teams(team_id),
    name VARCHAR(100) NOT NULL,
    category VARCHAR(50),
    price DECIMAL(10,2),
    stock INT,
    image_url VARCHAR(255)
);

--USUARIOS, FANS Y FAVORITOS
CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,
    username VARCHAR(100) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE fans (
    fan_id SERIAL PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    social_media VARCHAR(50) NOT NULL,
    profile_picture_url VARCHAR(255),
    team_id INT REFERENCES teams(team_id),
    registered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE favorites (
    favorite_id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(user_id) ON DELETE CASCADE,
    entity_type VARCHAR(20) CHECK (entity_type IN ('team','player')),
    entity_id INT NOT NULL
);

--ENCUESTAS Y VOTACIONES
CREATE TABLE polls (
    poll_id SERIAL PRIMARY KEY,
    question TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP
);

CREATE TABLE poll_votes (
    vote_id SERIAL PRIMARY KEY,
    poll_id INT REFERENCES polls(poll_id) ON DELETE CASCADE,
    user_id INT REFERENCES users(user_id),
    option_selected VARCHAR(100)
);



CREATE TABLE roles (
    role_id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE,
    description TEXT
);
ALTER TABLE users
ADD COLUMN role_id INT,
ADD CONSTRAINT fk_user_role
 FOREIGN KEY (role_id) REFERENCES roles(role_id);

	
INSERT INTO roles (name, description) VALUES ('ADMIN', 'Administrador del sistema');
INSERT INTO roles (name, description) VALUES ('USER', 'Usuario estándar del sistema');

-- Insertar usuario 'admin' (Rol: ADMIN, asumiendo role_id = 1)
INSERT INTO users (username, email, password_hash, role_id)
VALUES ('admin', 'admin@scoresense.com', 'TU_HASH_ADMIN', 
        (SELECT role_id FROM roles WHERE name = 'ADMIN'));

-- Insertar usuario 'usePrueba' (Rol: USER, asumiendo role_id = 2)
INSERT INTO users (username, email, password_hash, role_id)
VALUES ('usePrueba', 'userprueba@scoresense.com', 'TU_HASH_USERPRUEBA', 
        (SELECT role_id FROM roles WHERE name = 'USER'));


Select * from users;
Select * from roles;
Select * from players;
Select * from teams;
Select * from coaches;
Select * from matches;
Select * from referee;




ALTER TABLE matches
ADD COLUMN referee_id INT REFERENCES referee(referee_id);


--Mau - Matches ,player stats,players, news,favorites


INSERT INTO leagues (name, country, season, level) VALUES
('Liga MX', 'Mexico', 'Apertura 2025', 'First Division'),
('La Liga', 'Spain', '2024-2025', 'First Division'),
('Premier League', 'England', '2024-2025', 'First Division'),
('Serie A', 'Italy', '2024-2025', 'First Division'),
('Bundesliga', 'Germany', '2024-2025', 'First Division'),
('Ligue 1', 'France', '2024-2025', 'First Division'),
('MLS', 'USA', '2025', 'First Division'),
('Eredivisie', 'Netherlands', '2024-2025', 'First Division'),
('Primeira Liga', 'Portugal', '2024-2025', 'First Division'),
('Brasileirão Série A', 'Brazil', '2025', 'First Division');


-- 3 Equipos de Liga MX (league_id = 1)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Club Universidad Nacional (Pumas)', 'Mexico', 1954, 'Estadio Olímpico Universitario', 'NA', 1),
('Club America', 'Mexico', 1916, 'Estadio Azteca', 'NA', 1),
('Chivas Guadalajara', 'Mexico', 1906, 'Estadio Akron', 'NA', 1);

-- 3 Equipos de Premier League (league_id = 3)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Manchester United', 'England', 1878, 'Old Trafford', 'NA', 3),
('Liverpool FC', 'England', 1892, 'Anfield', 'NA', 3),
('Arsenal FC', 'England', 1886, 'Emirates Stadium', 'NA', 3);

-- 3 Equipos de La Liga (league_id = 2)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Real Madrid CF', 'Spain', 1902, 'Santiago Bernabéu', 'NA', 2),
('FC Barcelona', 'Spain', 1899, 'Spotify Camp Nou', 'NA', 2),
('Atlético de Madrid', 'Spain', 1903, 'Cívitas Metropolitano', 'NA', 2);

-- 3 Equipos de Serie A (league_id = 4)
INSERT INTO teams (name, country, founded_year, stadium, logo_url, league_id) VALUES
('Juventus FC', 'Italy', 1897, 'Allianz Stadium', 'NA', 4),
('AC Milan', 'Italy', 1899, 'San Siro', 'NA', 4),
('Inter Milan', 'Italy', 1908, 'San Siro', 'NA', 4);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Marcus Rashford', 'Delantero', 27, 'England', 185, 70, 7),
('Bruno Fernandes', 'Mediocampista', 30, 'Portugal', 179, 80, 7),
('Casemiro', 'Mediocampista', 32, 'Brazil', 185, 84, 7),
('Raphaël Varane', 'Defensa', 31, 'France', 191, 81, 7),
('André Onana', 'Portero', 28, 'Cameroon', 190, 93, 7),
('Mason Mount', 'Mediocampista', 25, 'England', 178, 74, 7),
('Alejandro Garnacho', 'Delantero', 20, 'Argentina', 180, 70, 7);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Vinícius Júnior', 'Delantero', 25, 'Brazil', 176, 73, 4),
('Jude Bellingham', 'Mediocampista', 21, 'England', 186, 78, 4),
('Thibaut Courtois', 'Portero', 32, 'Belgium', 200, 96, 4),
('Eduardo Camavinga', 'Mediocampista', 22, 'France', 182, 68, 4),
('Éder Militão', 'Defensa', 26, 'Brazil', 186, 78, 4),
('Toni Kroos', 'Mediocampista', 34, 'Germany', 183, 76, 4),
('Federico Valverde', 'Mediocampista', 26, 'Uruguay', 182, 78, 4),
('Rodrygo', 'Delantero', 23, 'Brazil', 175, 64, 4);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Alexis Vega', 'Delantero', 27, 'Mexico', 174, 73, 3),
('Roberto Alvarado', 'Mediocampista', 26, 'Mexico', 176, 67, 3),
('Jesús Orozco', 'Defensa', 22, 'Mexico', 183, 75, 3),
('Fernando Gago', 'Mediocampista', 38, 'Argentina', 177, 74, 3);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Henry Martín', 'Delantero', 32, 'Mexico', 178, 79, 2),
('Julián Quiñones', 'Delantero', 27, 'Colombia', 178, 76, 2),
('Álvaro Fidalgo', 'Mediocampista', 28, 'Spain', 174, 71, 2),
('Luis Malagón', 'Portero', 27, 'Mexico', 181, 75, 2);

INSERT INTO players (name, position, age, nationality, height, weight, team_id) VALUES
('Keylor Navas', 'Portero', 38, 'Costa Rica', 185, 80, 1),
('Nathan Silva', 'Defensa', 29, 'Brazil', 182, 84, 1),
('Rubén Duarte', 'Defensa', 30, 'Spain', 180, 75, 1),
('José Caicedo', 'Mediocampista', 24, 'Colombia', 179, 75, 1),
('Adalberto Carrasquilla', 'Mediocampista', 27, 'Panama', 170, 65, 1),
('Guillermo Martínez', 'Delantero', 31, 'Mexico', 191, 91, 1),
('José Juan Macías', 'Delantero', 26, 'Mexico', 178, 76, 1);

---------------data
-- Asunciones de team_id (basadas en tu última imagen y orden de inserción):
-- Pumas: 1, America: 2, Chivas: 3
-- Manchester United: 4, Liverpool FC: 5, Arsenal FC: 6
-- Real Madrid CF: 7, FC Barcelona: 8, Atlético de Madrid: 9
-- Juventus FC: 10

-- Liga MX (3 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
	('Efraín Juárez', 'Mexico', 5, 1),      -- Pumas
('André Jardine', 'Brazil', 12, 2),     -- Club America
('Fernando Gago', 'Argentina', 4, 3);    -- Chivas Guadalajara

-- Premier League (2 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Erik ten Hag', 'Netherlands', 10, 4),  -- Manchester United
('Jürgen Klopp', 'Germany', 24, 5);      -- Liverpool FC (team_id 5)

-- Premier League (1 Entrenador)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Mikel Arteta', 'Spain', 7, 6);         -- Arsenal FC (team_id 6)

-- La Liga (3 Entrenadores)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Carlo Ancelotti', 'Italy', 28, 7),     -- Real Madrid CF (team_id 7)
('Hansi Flick', 'Germany', 15, 8),       -- FC Barcelona (team_id 8)
('Diego Simeone', 'Argentina', 18, 9);   -- Atlético de Madrid (team_id 9)

-- Serie A (1 Entrenador)
INSERT INTO coaches (name, nationality, experienced_years, team_id) VALUES
('Thiago Motta', 'Italy', 6, 10);        -- Juventus FC (team_id 10)




-----------
INSERT INTO referee (name, nationality, experience_years) VALUES
('Arturo Ramos', 'Mexico', 10),
('Alejandro Hernández', 'Spain', 15),
('Michael Oliver', 'England', 18),
('Daniele Orsato', 'Italy', 20),
('Clément Turpin', 'France', 14);


-- JORNADA 1
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-28', 1, 2, 2, 1, 1),
('2025-11-28', 3, 12, 1, 1, 1);

-- JORNADA 2
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-29', 7, 8, 3, 2, 2),
('2025-11-29', 9, 7, 0, 1, 2);

-- JORNADA 3
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-11-30', 4, 5, 1, 1, 3),
('2025-11-30', 6, 4, 2, 0, 3);

-- JORNADA 4
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-01', 10, 11, 0, 0, 4),
('2025-12-01', 12, 10, 2, 1, 4);

-- JORNADA 5
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-05', 8, 9, 4, 1, 5),
('2025-12-05', 5, 6, 3, 0, 5);

-- JORNADA 6
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-06', 11, 12, 1, 2, 1),
('2025-12-06', 2, 3, 0, 0, 1);

-- JORNADA 7
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-07', 1, 3, 3, 0, 2),
('2025-12-07', 2, 1, 1, 0, 2);

-- JORNADA 8
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-08', 4, 6, 0, 2, 3),
('2025-12-08', 7, 9, 2, 2, 3);

-- JORNADA 9
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-09', 10, 5, 1, 0, 4),
('2025-12-09', 3, 2, 1, 3, 4);

-- JORNADA 10
INSERT INTO matches (match_date, home_team, away_team, home_score, away_score, referee_id) VALUES
('2025-12-10', 6, 5, 2, 1, 5),
('2025-12-10', 8, 7, 1, 1, 5);


-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 1: Pumas (1) vs America (2) | Resultado: 2-1
-- =============================================

-- Gol de Guillermo Martínez (Pumas - ID 29)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played, yellow_cards) 
VALUES (29, 1, 1, 0, 90, 0);

-- Gol de JJ Macías (Pumas - ID 30) 
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (30, 1, 1, 0, 45);

-- Asistencia de Carrasquilla (ID 28)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (28, 1, 0, 1, 85);

-- Gol de Henry Martín (América - ID 20)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (20, 1, 1, 0, 90);

-- Tarjeta amarilla para Álvaro Fidalgo (América - ID 22)
INSERT INTO player_stats (player_id, match_id, yellow_cards, minutes_played) 
VALUES (22, 1, 1, 90);

-- Portero Keylor Navas (Pumas - ID 24)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (24, 1, 90);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 2: Chivas (3) vs Inter (12) | Resultado: 1-1
-- =============================================

-- Gol de Alexis Vega (Chivas - ID 16) con amarilla
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played, yellow_cards) 
VALUES (16, 2, 1, 0, 88, 1);

-- Asistencia de Roberto Alvarado (Chivas - ID 17)
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (17, 2, 0, 1, 90);

-- Fernando Gago (Chivas - ID 19) - CORREGIDO: Se eliminó la columna 'fouls'
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (19, 2, 90);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 3: Team 7 vs Team 8 | Resultado: 3-2
-- (Jugadores Man Utd vs Barcelona segun lógica de IDs cruzados)
-- =============================================

-- Marcus Rashford (ID 1) - Doblete
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (1, 3, 2, 0, 90);

-- Bruno Fernandes (ID 2) - 1 Gol y 1 Asistencia
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (2, 3, 1, 1, 90);

-- Casemiro (ID 3) - Tarjeta Roja
INSERT INTO player_stats (player_id, match_id, red_cards, minutes_played) 
VALUES (3, 3, 1, 65);

-- Alejandro Garnacho (ID 7) - Entró de cambio
INSERT INTO player_stats (player_id, match_id, minutes_played, assists) 
VALUES (7, 3, 25, 1);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 5: Team 4 vs Team 5 | Resultado: 1-1
-- (Jugadores Real Madrid)
-- =============================================

-- Vinícius Júnior (ID 8) - 1 Gol y Amarilla
INSERT INTO player_stats (player_id, match_id, goals, minutes_played, yellow_cards) 
VALUES (8, 5, 1, 90, 1);

-- Jude Bellingham (ID 9) - 1 Asistencia
INSERT INTO player_stats (player_id, match_id, assists, minutes_played) 
VALUES (9, 5, 1, 90);

-- Thibaut Courtois (ID 10) - Portero
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (10, 5, 90);

-- Toni Kroos (ID 13)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (13, 5, 80);

-- =============================================
-- ESTADÍSTICAS DEL PARTIDO 7: Pumas (1) vs Chivas (3) | Resultado: 3-0
-- =============================================

-- Hat-trick de Memo Martínez (Pumas - ID 29)
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (29, 7, 3, 90);

-- Asistencias de Nathan Silva (ID 25)
INSERT INTO player_stats (player_id, match_id, assists, minutes_played) 
VALUES (25, 7, 1, 90);

-- Orozco (ID 18) expulsado
INSERT INTO player_stats (player_id, match_id, red_cards, minutes_played) 
VALUES (18, 7, 1, 30);

-- =============================================
-- OTROS PARTIDOS
-- =============================================

-- Partido 6: Valverde (ID 14) con amarilla
INSERT INTO player_stats (player_id, match_id, yellow_cards, minutes_played) 
VALUES (14, 6, 1, 90);

-- Partido 9: Chivas (3) vs America (2)
-- Alvarado (ID 17) Gol
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (17, 9, 1, 90);

-- Quiñones (ID 21) Doblete
INSERT INTO player_stats (player_id, match_id, goals, assists, minutes_played) 
VALUES (21, 9, 2, 0, 88);

-- Fidalgo (ID 22) Gol
INSERT INTO player_stats (player_id, match_id, goals, minutes_played) 
VALUES (22, 9, 1, 90);

-- Luis Malagón (ID 23)
INSERT INTO player_stats (player_id, match_id, minutes_played) 
VALUES (23, 9, 90);
